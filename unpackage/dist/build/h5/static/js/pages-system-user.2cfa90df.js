(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-system-user"],{3138:function(e,t,n){"use strict";n.r(t);var r=n("b266"),a=n.n(r);for(var s in r)"default"!==s&&function(e){n.d(t,e,(function(){return r[e]}))}(s);t["default"]=a.a},4494:function(e,t,n){"use strict";n("a9e3"),n("e25e"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n("3153"),a={name:"uniDateformat",props:{date:{type:[Object,String,Number],default:function(){return Date.now()}},locale:{type:String,default:"zh"},threshold:{type:Array,default:function(){return[0,0]}},format:{type:String,default:"yyyy/MM/dd hh:mm:ss"},refreshRate:{type:[Number,String],default:0}},data:function(){return{refreshMark:0}},computed:{dateShow:function(){return this.refreshMark,(0,r.friendlyDate)(this.date,{locale:this.locale,threshold:this.threshold,format:this.format})}},watch:{refreshRate:{handler:function(){this.setAutoRefresh()},immediate:!0}},methods:{refresh:function(){this.refreshMark++},setAutoRefresh:function(){var e=this;clearInterval(this.refreshInterval),this.refreshRate&&(this.refreshInterval=setInterval((function(){e.refresh()}),parseInt(this.refreshRate)))}}};t.default=a},9490:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tree=t.remove=t.update=t.add=t.getList=void 0;var r=n("65a6"),a=function(e){return(0,r.request)("system/tenant/list",e)};t.getList=a;var s=function(e){return(0,r.request)("system/tenant/add",e)};t.add=s;var i=function(e){return(0,r.request)("system/tenant/update",e)};t.update=i;var u=function(e){return(0,r.request)("system/tenant/remove",e)};t.remove=u;var o=function(e){return(0,r.request)("system/tenant/tree",e)};t.tree=o},"9dbc":function(e,t,n){"use strict";n.r(t);var r=n("a7c1"),a=n("3138");for(var s in a)"default"!==s&&function(e){n.d(t,e,(function(){return a[e]}))}(s);var i,u=n("f0c5"),o=Object(u["a"])(a["default"],r["b"],r["c"],!1,null,"c2c5bf62",null,!1,r["a"],i);t["default"]=o.exports},a7c1:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return r}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"uni-container"},[n("avue-crud",{ref:"crud",attrs:{permission:e.permissionList,option:e.option,page:e.page,"table-loading":e.loading,data:e.data},on:{"row-del":function(t){arguments[0]=t=e.$handleEvent(t),e.rowDel.apply(void 0,arguments)},"row-update":function(t){arguments[0]=t=e.$handleEvent(t),e.rowUpdate.apply(void 0,arguments)},"row-save":function(t){arguments[0]=t=e.$handleEvent(t),e.rowSave.apply(void 0,arguments)},"search-change":function(t){arguments[0]=t=e.$handleEvent(t),e.searchChange.apply(void 0,arguments)},"search-reset":function(t){arguments[0]=t=e.$handleEvent(t),e.searchReset.apply(void 0,arguments)},"selection-change":function(t){arguments[0]=t=e.$handleEvent(t),e.selectionChange.apply(void 0,arguments)},"current-change":function(t){arguments[0]=t=e.$handleEvent(t),e.currentChange.apply(void 0,arguments)},"size-change":function(t){arguments[0]=t=e.$handleEvent(t),e.sizeChange.apply(void 0,arguments)},"on-load":function(t){arguments[0]=t=e.$handleEvent(t),e.loadData.apply(void 0,arguments)}},scopedSlots:e._u([{key:"last_login_date",fn:function(e){return[n("uni-dateformate",{attrs:{date:e.row.last_login_date}})]}},{key:"role",fn:function(t){return[n("v-uni-view",[e._v(e._s(t.row.roleShow.join(",")))])]}},{key:"dept",fn:function(t){return[n("v-uni-view",[e._v(e._s(t.row.deptShow.join(",")))])]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1)},s=[]},aa62:function(e,t,n){"use strict";n.r(t);var r=n("4494"),a=n.n(r);for(var s in r)"default"!==s&&function(e){n.d(t,e,(function(){return r[e]}))}(s);t["default"]=a.a},b266:function(e,t,n){"use strict";var r=n("4ea4");n("4160"),n("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("5530")),s=r(n("814d")),i=r(n("e6a2")),u=n("e635"),o=n("9490"),c=n("e152"),d=n("c497"),l=n("ba3c"),f=n("2f62"),p={components:{uniDateformate:i.default},computed:(0,a.default)((0,a.default)({},(0,f.mapState)("app",["navBtn"])),{},{permissionList:function(){return{addBtn:this.navBtn.system_user_add||!1,viewBtn:this.navBtn.system_user_list||!1,delBtn:this.navBtn.system_user_remove||!1,editBtn:this.navBtn.system_user_update||!1}}}),data:function(){return{loading:!1,page:{pageSize:s.default.pages.pageSize,currentPage:s.default.pages.currentPage,total:0},form:{},params:{},option:{height:"auto",calcHeight:80,searchShow:!0,searchMenuSpan:6,rowKey:"_id",tip:!1,tree:!0,border:!0,index:!0,selection:!0,viewBtn:!0,column:[{label:"用户名称",prop:"username",search:!0,span:12,rules:[{required:!0,message:"请输入用户名称",trigger:"blur"}]},{label:"密码",prop:"password",span:12,hide:!0,editDisplay:!1,viewDisplay:!1,type:"password",rules:[{required:!0,message:"请输入密码",trigger:"blur"}]},{label:"用户昵称",prop:"nickname",search:!0,span:12},{label:"用户性别",prop:"gender",span:12,type:"select",props:{label:"dict_name",value:"dict_key"},dicData:[]},{label:"所属门店",prop:"tenantId",type:"tree",span:12,dicData:[],props:{label:"name",value:"_id"},search:!0,rules:[{required:!0,message:"请输入所属租户",trigger:"change"}]},{label:"用户角色",prop:"role",type:"tree",slot:!0,multiple:!0,checkStrictly:!0,width:150,dicData:[],span:12,props:{label:"role_name",value:"_id"},rules:[{required:!0,message:"请输入用户角色",trigger:"blur"}]},{label:"部门",prop:"dept",type:"tree",slot:!0,multiple:!0,checkStrictly:!0,width:150,dicData:[],span:12,props:{label:"dept_name",value:"_id"},rules:[{required:!1,message:"请输入用户部门",trigger:"blur"}]},{label:"用户状态",prop:"status",type:"select",value:0,props:{label:"dict_name",value:"dict_key",disabled:"disabled"},dicData:[],span:12,rules:[{required:!0,message:"请输入用户状态",trigger:"blur"}]},{label:"手机号码",prop:"mobile",span:12,rules:[{required:!0,message:"请输入手机号码",trigger:"blur"}]},{label:"最后登录时间",prop:"last_login_date",slot:!0,width:140,span:12,display:!1},{label:"最后登录时 IP 地址",prop:"last_login_ip",width:120,span:12,display:!1}]},data:[]}},created:function(){var e=this;(0,o.tree)().then((function(t){var n=e.findObject(e.option.column,"tenantId");n.dicData=t})),(0,d.getDictByDictCode)({dict_code:"gender"}).then((function(t){var n=e.findObject(e.option.column,"gender");n.dicData=t})),(0,d.getDictByDictCode)({dict_code:"user_status"}).then((function(t){var n=e.findObject(e.option.column,"status");n.dicData=t}))},watch:{"form.tenantId":{handler:function(e){var t=this;e&&((0,c.tree)({tenantId:e}).then((function(e){var n=t.findObject(t.option.column,"role");n.dicData=e})),(0,l.tree)({tenantId:e}).then((function(e){var n=t.findObject(t.option.column,"dept");n.dicData=e})))},deep:!0}},methods:{rowDel:function(e){var t=this;this.$confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){(0,u.remove)({_ids:[e._id]}).then((function(e){t.$message({message:"删除成功",type:"success"}),t.loadData()}))}))},rowUpdate:function(e,t,n,r){var a=this;(0,u.update)(e).then((function(){a.loadData(),a.$message({message:"修改成功",type:"success"}),n()})).catch((function(e){n()}))},rowSave:function(e,t,n){var r=this;(0,u.add)(e).then((function(){r.loadData(),r.$message({message:"新增成功",type:"success"}),t()})).catch((function(e){t()}))},searchReset:function(){this.params={},this.loadData()},searchChange:function(e,t){this.params=e,this.loadData(),t()},selectionChange:function(){},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},loadData:function(){var e=this;this.$nextTick((function(){e.loading=!0,e.params.page=e.page.currentPage,e.params.size=e.page.pageSize,(0,u.getList)(e.params).then((function(t){if(t.data&&t.data.length){var n={};t.data.forEach((function(e){e.roleShow=[],e.deptShow=[],e.roles.forEach((function(e){n[e._id]=e.role_name})),e.role.forEach((function(t){n[t]?e.roleShow.push(n[t]):e.roleShow.push(t)})),e.depts.forEach((function(t){e.deptShow.push(t.dept_name)}))}))}e.data=t.data,e.loading=!1,e.page.total=t.total})).catch((function(){e.loading=!1}))}))}}};t.default=p},ba3c:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tree=t.remove=t.update=t.add=t.getList=void 0;var r=n("65a6"),a=function(e){return(0,r.request)("system/dept/list",e)};t.getList=a;var s=function(e){return(0,r.request)("system/dept/add",e)};t.add=s;var i=function(e){return(0,r.request)("system/dept/update",e)};t.update=i;var u=function(e){return(0,r.request)("system/dept/remove",e)};t.remove=u;var o=function(e){return(0,r.request)("system/dept/tree",e)};t.tree=o},c497:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDictByDictCode=t.tree=t.remove=t.update=t.add=t.getList=void 0;var r=n("65a6"),a=function(e){return(0,r.request)("system/dict/list",e)};t.getList=a;var s=function(e){return(0,r.request)("system/dict/add",e)};t.add=s;var i=function(e){return(0,r.request)("system/dict/update",e)};t.update=i;var u=function(e){return(0,r.request)("system/dict/remove",e)};t.remove=u;var o=function(e){return(0,r.request)("system/dict/tree",e)};t.tree=o;var c=function(e){return(0,r.request)("system/dict/getDictByDictCode",e)};t.getDictByDictCode=c},dac0:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return r}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-text",[e._v(e._s(e.dateShow))])},s=[]},e152:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setRoleMenus=t.getRoleMenus=t.tree=t.remove=t.update=t.add=t.getList=void 0;var r=n("65a6"),a=function(e){return(0,r.request)("system/role/list",e)};t.getList=a;var s=function(e){return(0,r.request)("system/role/add",e)};t.add=s;var i=function(e){return(0,r.request)("system/role/update",e)};t.update=i;var u=function(e){return(0,r.request)("system/role/remove",e)};t.remove=u;var o=function(e){return(0,r.request)("system/role/tree",e)};t.tree=o;var c=function(e){return(0,r.request)("system/role/getRoleMenus",e)};t.getRoleMenus=c;var d=function(e){return(0,r.request)("system/role/setRoleMenus",e)};t.setRoleMenus=d},e635:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.update=t.add=t.getList=void 0;var r=n("65a6"),a=function(e){return(0,r.request)("system/user/list",e)};t.getList=a;var s=function(e){return(0,r.request)("system/user/add",e)};t.add=s;var i=function(e){return(0,r.request)("system/user/update",e)};t.update=i;var u=function(e){return(0,r.request)("system/user/remove",e)};t.remove=u},e6a2:function(e,t,n){"use strict";n.r(t);var r=n("dac0"),a=n("aa62");for(var s in a)"default"!==s&&function(e){n.d(t,e,(function(){return a[e]}))}(s);var i,u=n("f0c5"),o=Object(u["a"])(a["default"],r["b"],r["c"],!1,null,"808c1684",null,!1,r["a"],i);t["default"]=o.exports}}]);