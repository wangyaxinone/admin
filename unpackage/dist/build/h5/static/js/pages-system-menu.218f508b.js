(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-system-menu"],{"1ec6":function(n,o,i){"use strict";i.r(o);var e=i("c28f"),t=i.n(e);for(var c in e)"default"!==c&&function(n){i.d(o,n,(function(){return e[n]}))}(c);o["default"]=t.a},"4ae8":function(n,o,i){"use strict";i.d(o,"b",(function(){return t})),i.d(o,"c",(function(){return c})),i.d(o,"a",(function(){return e}));var e={uniClientdb:i("a83f").default},t=function(){var n=this,o=n.$createElement,i=n._self._c||o;return i("v-uni-view",[i("v-uni-view",{staticClass:"uni-container"},[i("uni-clientdb",{ref:"dataQuery",attrs:{collection:n.collectionName,options:n.options,where:n.where,"page-data":"replace",orderby:n.orderby,getcount:!0,"page-size":n.options.pageSize,"page-current":n.options.pageCurrent,prtLoad:n.clientdbload},scopedSlots:n._u([{key:"default",fn:function(o){var e=o.data,t=o.loading;return[i("avue-crud",{ref:"crud",attrs:{option:n.option,"table-loading":t,data:e},on:{"row-del":function(o){arguments[0]=o=n.$handleEvent(o),n.rowDel.apply(void 0,arguments)},"row-update":function(o){arguments[0]=o=n.$handleEvent(o),n.rowUpdate.apply(void 0,arguments)},"row-save":function(o){arguments[0]=o=n.$handleEvent(o),n.rowSave.apply(void 0,arguments)},"search-change":function(o){arguments[0]=o=n.$handleEvent(o),n.searchChange.apply(void 0,arguments)},"search-reset":function(o){arguments[0]=o=n.$handleEvent(o),n.searchReset.apply(void 0,arguments)},"selection-change":function(o){arguments[0]=o=n.$handleEvent(o),n.selectionChange.apply(void 0,arguments)},"current-change":function(o){arguments[0]=o=n.$handleEvent(o),n.currentChange.apply(void 0,arguments)},"size-change":function(o){arguments[0]=o=n.$handleEvent(o),n.sizeChange.apply(void 0,arguments)},"on-load":function(o){arguments[0]=o=n.$handleEvent(o),n.loadData.apply(void 0,arguments)}},scopedSlots:n._u([{key:"menu",fn:function(o){var e=o.type,t=o.size,c=o.row;return[i("el-button",{attrs:{icon:"el-icon-plus",size:t,type:e},on:{click:function(o){arguments[0]=o=n.$handleEvent(o),n.addChildMenus(c)}}},[n._v("添加子菜单")])]}}],null,!0),model:{value:n.form,callback:function(o){n.form=o},expression:"form"}})]}}])})],1)],1)},c=[]},"5d9f":function(n,o,i){"use strict";var e;i.d(o,"b",(function(){return t})),i.d(o,"c",(function(){return c})),i.d(o,"a",(function(){return e}));var t=function(){var n=this,o=n.$createElement,i=n._self._c||o;return i("v-uni-view",[n._t("default",null,{options:n.options,data:n.dataList,pagination:n.paginationInternal,loading:n.loading,error:n.errorMessage})],2)},c=[]},"5dc7":function(n,o,i){"use strict";i.r(o);var e=i("4ae8"),t=i("afa6");for(var c in t)"default"!==c&&function(n){i.d(o,n,(function(){return t[n]}))}(c);var a,r=i("f0c5"),s=Object(r["a"])(t["default"],e["b"],e["c"],!1,null,"1dda44b4",null,!1,e["a"],a);o["default"]=s.exports},"91ab":function(n,o,i){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var e=[{label:"通用图标",list:["iconfont iconicon_roundadd","iconfont iconicon_compile","iconfont iconicon_glass","iconfont iconicon_roundclose","iconfont iconicon_roundreduce","iconfont iconicon_delete","iconfont iconicon_shakehands","iconfont iconicon_task_done","iconfont iconicon_voipphone","iconfont iconicon_safety","iconfont iconicon_work","iconfont iconicon_study","iconfont iconicon_task","iconfont iconicon_subordinate","iconfont iconicon_star","iconfont iconicon_setting","iconfont iconicon_sms","iconfont iconicon_share","iconfont iconicon_secret","iconfont iconicon_scan_namecard","iconfont iconicon_principal","iconfont iconicon_group","iconfont iconicon_send","iconfont iconicon_scan","iconfont iconicon_search","iconfont iconicon_refresh","iconfont iconicon_savememo","iconfont iconicon_QRcode","iconfont iconicon_im_keyboard","iconfont iconicon_redpacket","iconfont iconicon_photo","iconfont iconicon_qq","iconfont iconicon_wechat","iconfont iconicon_phone","iconfont iconicon_namecard","iconfont iconicon_notice","iconfont iconicon_next_arrow","iconfont iconicon_left","iconfont iconicon_more","iconfont iconicon_details","iconfont iconicon_message","iconfont iconicon_mobilephone","iconfont iconicon_im_voice","iconfont iconicon_GPS","iconfont iconicon_ding","iconfont iconicon_exchange","iconfont iconicon_cspace","iconfont iconicon_doc","iconfont iconicon_dispose","iconfont iconicon_discovery","iconfont iconicon_community_line","iconfont iconicon_cloud_history","iconfont iconicon_coinpurse_line","iconfont iconicon_airplay","iconfont iconicon_at","iconfont iconicon_addressbook","iconfont iconicon_boss","iconfont iconicon_addperson","iconfont iconicon_affiliations_li","iconfont iconicon_addmessage","iconfont iconicon_addresslist","iconfont iconicon_add"]},{label:"系统图标",list:["iconfont icon-zhongyingwen","iconfont icon-caidan","iconfont icon-rizhi1","iconfont icon-zhuti","iconfont icon-suoping","iconfont icon-bug","iconfont icon-qq1","iconfont icon-weixin1","iconfont icon-shouji","iconfont icon-mima","iconfont icon-yonghu","iconfont icon-yanzhengma","iconfont icon-canshu","iconfont icon-dongtai","iconfont icon-iconset0265","iconfont icon-shujuzhanshi2","iconfont icon-tuichuquanping","iconfont icon-rizhi","iconfont icon-cuowutishitubiao","iconfont icon-debug","iconfont icon-iconset0216","iconfont icon-quanxian","iconfont icon-quanxian","iconfont icon-shuaxin","iconfont icon-bofangqi-suoping","iconfont icon-quanping","iconfont icon-navicon","iconfont icon-biaodan","iconfont icon-liuliangyunpingtaitubiao08","iconfont icon-caidanguanli","iconfont icon-cuowu","iconfont icon-wxbgongju","iconfont icon-tuichu","iconfont icon-daohanglanmoshi02","iconfont icon-changyonglogo27","iconfont icon-biaoge","iconfont icon-baidu1","iconfont icon-tubiao","iconfont icon-souhu","iconfont icon-msnui-360","iconfont icon-iframe","iconfont icon-huanyingye"]}];o.default=e},a185:function(n,o,i){"use strict";(function(n){var e=i("4ea4");i("4e82"),i("4d63"),i("ac1f"),i("25f0"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var t,c=e(i("f513")),a=e(i("91ab")),r=n.database(),s=(r.command,"opendb-admin-menus"),u="create_date desc",d={data:function(){return{where:{},orderby:u,collectionName:s,options:{pageSize:c.default.pages.pageSize,pageCurrent:c.default.pages.pageCurrent},form:{},params:{},option:{height:"auto",calcHeight:80,searchShow:!0,searchMenuSpan:6,rowKey:"_id",tip:!1,tree:!0,border:!0,index:!0,selection:!0,viewBtn:!0,menuWidth:300,column:[{label:"菜单名称",prop:"name",search:!0,width:150,span:12,rules:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},{label:"菜单 Id",prop:"menu_id",span:12,rules:[{required:!0,message:"请输入菜单 Id",trigger:"change"}]},{label:"父级菜单",prop:"parent_id",span:12,type:"tree",dicData:[],props:{label:"name",value:"menu_id"}},{label:"图标选择器",prop:"icon",type:"icon",iconList:a.default},{label:"url",prop:"url",span:12,rules:[{required:!1,message:"请输入url",trigger:"change"}]},{label:"类型",prop:"type",span:12,type:"select",value:1,dicData:[{label:"菜单",value:1},{label:"按钮",value:2}],rules:[{required:!0,message:"请输入url",trigger:"change"}]},{label:"角色排序",prop:"sort",type:"number",span:12,rules:[{required:!0,message:"请输入角色排序",trigger:"blur"}]},{label:"菜单状态",prop:"enable",type:"switch",search:!0,span:12,value:!0,dicData:[{label:"禁用",value:!1},{label:"启用",value:!0}]}]},data:[]}},created:function(){t=this},methods:{addChildMenus:function(n){var o=this;this.$refs.crud.rowAdd(),setTimeout((function(){o.form.parent_id=n.menu_id}),300)},clientdbload:function(n){n.sort((function(n,o){return n.sort>o.sort?1:-1}));var o=t.$getTree(n,{id:"menu_id",children:"children",parentId:"parent_id"}),i=t.findObject(t.option.column,"parent_id");return i.dicData=o,o},rowDel:function(n){var o=this;n.children&&n.children.length?this.$message({message:"请先删除子菜单！",type:"warning"}):this.$confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.collection(s).doc(n._id).remove().then((function(n){o.$message({message:"删除成功",type:"success"}),o.loadData()})).catch((function(n){o.$message({message:n.message||"删除失败",type:"error"})}))}))},rowUpdate:function(n,o,i,e){var t=this;r.collection(s).where({_id:n._id}).update({name:n.name,menu_id:n.menu_id,parent_id:n.parent_id,url:n.url,type:n.type,sort:n.sort,enable:n.enable,icon:n.icon}).then((function(){t.loadData(),t.$message({message:"修改成功",type:"success"}),i()})).catch((function(n){t.$message({message:n.message||"修改失败",type:"error"}),i()}))},rowSave:function(n,o,i){var e=this;r.collection(s).add({name:n.name,menu_id:n.menu_id,parent_id:n.parent_id,url:n.url,type:n.type,sort:n.sort,enable:n.enable,icon:n.icon}).then((function(){e.loadData(),e.$message({message:"新增成功",type:"success"}),o()})).catch((function(n){e.$message({message:n.message||"新增失败",type:"error"}),o()}))},searchReset:function(){this.where={},this.params={},this.loadData()},searchChange:function(n,o){this.params=n,this.params.name&&(this.where.name=new RegExp(this.params.name)),void 0!==this.params.enable&&(this.where.enable=this.params.enable),this.loadData(),o()},selectionChange:function(){},currentChange:function(n){this.options.pageCurrent=n},sizeChange:function(n){this.options.pageSize=n},loadData:function(){var n=this,o=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$nextTick((function(){n.$refs.dataQuery.loadData({clear:o})}))}}};o.default=d}).call(this,i("a9ff")["default"])},a83f:function(n,o,i){"use strict";i.r(o);var e=i("5d9f"),t=i("1ec6");for(var c in t)"default"!==c&&function(n){i.d(o,n,(function(){return t[n]}))}(c);var a,r=i("f0c5"),s=Object(r["a"])(t["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],a);o["default"]=s.exports},afa6:function(n,o,i){"use strict";i.r(o);var e=i("a185"),t=i.n(e);for(var c in e)"default"!==c&&function(n){i.d(o,n,(function(){return e[n]}))}(c);o["default"]=t.a},c28f:function(n,o,i){"use strict";(function(n){var e=i("4ea4");i("4160"),i("a434"),i("a9e3"),i("b64b"),i("ac1f"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var t=e(i("2909")),c=n.database(),a=(c.command,{load:"load",error:"error"}),r={add:"add",replace:"replace"},s=["collection","action","field","pageCurrent","pageSize","getcount","orderby","where"],u={props:{prtLoad:{type:Function},options:{type:[Object,Array],default:function(){return{}}},collection:{type:String,default:""},action:{type:String,default:""},field:{type:String,default:""},pageData:{type:String,default:"add"},pageCurrent:{type:Number,default:1},pageSize:{type:Number,default:10},getcount:{type:[Boolean,String],default:!1},orderby:{type:String,default:""},where:{type:[String,Object],default:""},getone:{type:[Boolean,String],default:!1},manual:{type:Boolean,default:!1}},data:function(){return{loading:!1,dataList:[],paginationInternal:{current:this.pageCurrent,size:this.pageSize,total:0},errorMessage:""}},created:function(){var n=this;this._isEnded=!1,this.$watch((function(){var o=[];return s.forEach((function(i){o.push(n[i])})),o}),(function(o,i){n.clear(),n.reset(),n._execLoadData()})),this.manual||this.loadData()},beforeDestroy:function(){},methods:{loadData:function(){var n=null;if(1===arguments.length){var o=arguments[0];"function"===typeof o?n=o:o.clear&&(this.clear(),this.reset()),void 0!==o.current&&(this.paginationInternal.current=o.current)}else 2===arguments.length&&(n=arguments[1]);this._execLoadData(n)},loadMore:function(){this._isEnded||this._execLoadData()},clear:function(){this._isEnded=!1,this.dataList=[]},reset:function(){this.paginationInternal.current=1},_execLoadData:function(n){var o=this;this.loading||(this.loading=!0,this.errorMessage="",this._getExec().then((function(i){o.loading=!1;var e=i.result,c=e.data,s=e.count;if(o.prtLoad)c=o.prtLoad(c);if(o._isEnded=c.length<o.pageSize,n&&n(c,o._isEnded),o._dispatchEvent(a.load,c),o.getone)o.dataList=c.length?c[0]:void 0;else if(o.pageData===r.add){var u;(u=o.dataList).push.apply(u,(0,t.default)(c)),o.dataList.length&&o.paginationInternal.current++}else o.pageData===r.replace&&(o.dataList=c,o.paginationInternal.total=s)})).catch((function(i){o.loading=!1,o.errorMessage=i,n&&n(),o.$emit(a.error,i)})))},_getExec:function(){var n=c;this.action&&(n=n.action(this.action)),n=c.collection(this.collection),this.where&&Object.keys(this.where).length&&(n=n.where(this.where)),this.field&&(n=n.field(this.field)),this.orderby&&(n=n.orderBy(this.orderby));var o=this.paginationInternal,i=o.current,e=o.size;return n=n.skip(e*(i-1)).limit(e).get({getCount:this.getcount}),n},_dispatchEvent:function(n,o){this._changeDataFunction?this._changeDataFunction(o,this._isEnded):this.$emit(n,o,this._isEnded)}}};o.default=u}).call(this,i("a9ff")["default"])}}]);